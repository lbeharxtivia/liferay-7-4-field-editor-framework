(()=>{const e=(e,t)=>{let r=null;return(...n)=>{window.clearTimeout(r),r=window.setTimeout(()=>{e(...n)},t)}},t=e=>{const t=document.querySelector("#portlet_com_liferay_journal_web_portlet_JournalPortlet, .page-editor__item-configuration-sidebar"),r=document.evaluate(`//label[text()='${e}']`,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;return r?.closest(".form-group, .field-wrapper")?.querySelector("input")||r?.nextElementSibling?.querySelector("input")||r?.nextSibling},r=(e,t)=>{e.focus(),Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set.call(e,t),e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),document.body.focus(),e.dispatchEvent(new Event("blur",{bubbles:!0}))},n=e=>{const t=Math.random().toFixed(3),n=e.target?.previousSibling;n&&t&&r(n,t)},o=({observer:e,shouldDestroyObserver:r=!1})=>{const o=t("My Random Number");if(o){const t=document.createElement("button");t.className="btn btn-secondary random-number-button",t.type="button",t.innerHTML="Generate Number",t.addEventListener("click",n);const i=o.closest(".page-editor__sidebar__fieldset__field, .col-ddm");i&&i.classList.contains("col-ddm")&&t&&(t.style.height="2.5rem",t.style.alignSelf="center",t.style.marginBottom="1.375rem"),i&&!i.querySelector("random-number-button")&&(i.after(t),e&&r&&e.disconnect?.())}},i=()=>document.querySelector('input[name^="_com_liferay_journal_web_portlet_JournalPortlet_ddm$$Image"]'),a=()=>document.querySelector("#portlet_com_liferay_journal_web_portlet_JournalPortlet, .page-editor__topper.active").querySelector(".page-editor__topper.active img.page-editor__editable, .image-picker-preview>img"),l=async e=>{const n=(e=>{let t;if("input"===e.tagName.toLowerCase())try{const r=JSON.parse(e.value),{fileEntryId:n=null,url:o=null}=r;n&&o&&(t=(({fileEntryId:e,url:t,width:r})=>`/o/adaptive-media/image/${e}/Thumbnail-${r}x${r}/${t.split("/").slice(-1)[0].split("?")[0]}?t=${Date.now()}`)({fileEntryId:n,url:o,width:300}))}catch(e){console.error(e)}else if("img"===e.tagName.toLowerCase()){const r=e?.parentElement?.firstElementChild;t=r?.srcset}return t})("fragment"===e?a():i()),o=t("Image Url");n&&o&&r(o,n)},s=t=>{Liferay.imageObserver&&Liferay.imageObserver.disconnect?.();const r="fragment"===t?a():i();if(t&&r&&!Liferay.imageObserver){const n=e(()=>l(t),500);Liferay.imageObserver=new MutationObserver(n);const o={attributes:!0,childList:!1,subtree:!1};Liferay.imageObserver.observe(r,o)}l(t)},c=()=>{const t=document.querySelector("#_com_liferay_journal_web_portlet_JournalPortlet_fieldsContent");if(t){Liferay.fieldWebContentObserver&&Liferay.fieldWebContentObserver.disconnect?.();const r=e(()=>{s("content"),o({observer:n,shouldDestroyObserver:!0})},500);Liferay.fieldWebContentObserver=new MutationObserver(r);const n=Liferay.fieldWebContentObserver,i={attributes:!1,childList:!0,subtree:!0};n.observe(t,i)}},u=()=>{const t=document.querySelector(".page-editor__item-configuration-sidebar");if(t){Liferay.fieldFragmentObserver&&Liferay.fieldFragmentObserver.disconnect?.();const r=e(()=>{s("fragment"),o({observer:n,shouldDestroyObserver:!1})},500);Liferay.fieldFragmentObserver=new MutationObserver(r);const n=Liferay.fieldFragmentObserver,i={attributes:!1,childList:!0,subtree:!1};n.observe(t,i)}};Liferay.on("allPortletsReady",()=>{c(),setTimeout(u,500)}),Liferay.on("endNavigate",()=>{c(),setTimeout(u,500)})})();